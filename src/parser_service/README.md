# parser-service

Сервис для парсинга данных.

В рамках данного проекта используется для получения:
- сообщений из Telegram-чата [@chpsaratovlive](https://t.me/chpsaratovlive),
- сообщений об отключениях с сайта
[ООО «Концессии водоснабжения — Саратов»](https://www.kvs-saratov.ru/news/operativnyy-monitoring/).

Для парсинга Telegram используются pyrogram, а для парсинга сайта - BeautifulSoup и httpx.

Контроллеры `/messages` имеют общую структуру.
Идентификатор последнего полученного сообщения `last_message_id` в рамках данного проекта
извлекается из базы данных в главном сервисе `supervisor`.

> ### `GET /messages/tg/new/` / `GET /messages/tg/old/` / 
> ### `GET /messages/kvs/new/`
> 
> Возвращает список сообщений с ресурса.
>
> Параметры:
> - `last_message_id` (integer) - идентификатор последнего полученного сообщения.
>
> Ответ:
> - `id` (integer) - идентификатор сообщения на данном ресурсе,
> - `source` (string) - ресурс, с которого сообщение было получено,
> - `date` (datetime) - дата публикации сообщения,
> - `from_user` (string) - отправитель/источник сообщения,
> - `text` (string) - содержание сообщения,
> - `image` (string) - изображение, закодированное в строку Base64.
